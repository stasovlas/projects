строка запуска: imagej-win32.exe -batch main.ijm true
-batch - запуск в пакетном режиме
main.ijm - испоняемый макрос
true(false) - сохранять(не сохранять) изображения страниц с вычисленными отступами, сохраняются в папку "book", не изменяют оригинал

После запуска скрипта появится диалоговое окно выбора pdf-ки
Результаты сортировки страниц (после отработки скрипта) сохранятся в файл "res.json"

Скрипт работает не идеально, есть над чем работать, но в большинстве случаев точно определяет отступы. Возникают проблемы с изображениями, списками (то, что
пока обнаружил). Случаются непонятные выбросы, пока не знаю чем они обусловлены. Рядом лежит несколько небольших книжек, на них тестил. Возможные эсепшены не
обрабатовал, но их и не должно быть. Красоту кода особо не поддерживал, хотелось побыстрее написать. 
200 страниц обрабатываются примерно 2 мин., резервируется около 500 МБ оперативки.